@{
    Layout = null;
    bool isLoggedIn = true;
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - ExamGenerator</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body class="bg-gradient">
    <header class="topbar">
        <div class="container-fluid">
            <div class="logo">
                <span class="brand">ExamGenerator</span>
            </div>
            <nav class="nav-actions">
                <a class="plus-btn" href="#">Plus <span><!-- svg aquí --></span></a>
                <a class="register-btn" href="#">Mi Cuenta</a>
            </nav>
        </div>
    </header>

    <main class="main-content">
        @RenderBody()
    </main>



    <!-- Overlay -->
    <div id="overlay" class="overlay"></div>

    <!-- Popup login/registro -->
    <div id="authPopup" class="popup">
        <button class="close-btn" onclick="cerrarPopup()">✕</button>
        <h3 id="popupTitle">Inicia sesión</h3>
        <div class="card-container">
            <div class="card">
                <form id="loginForm" class="card-face front" action="/Account/Login" method="post">
                    <input type="email" name="email" placeholder="Email" />
                    <input type="password" name="pass" placeholder="Contraseña" />
                    <button type="submit" class="submit-btn">Ingresar</button>
                </form>
                <form id="registerForm" class="card-face back" action="/Account/Register" method="post">
                    <input type="text" name="name" placeholder="Nombre completo" />
                    <input type="email" name="email" placeholder="Email" />
                    <input type="password" name="pass" placeholder="Contraseña" />
                    <input type="password" name="confirmPass" placeholder="Confirmar contraseña" />
                    <button type="submit" class="submit-btn">Registrarse</button>
                </form>
            </div>
        </div>
        <a href="#" id="toggleForm" class="register-link">¿No tienes cuenta? Registrate</a>
    </div>

    <!-- Menú usuario -->
    <div id="userMenu" class="dropdown-menu" style="display:none;">
        <a href="/Account/Profile">Perfil</a>
        <a href="/Account/Logout">Cerrar sesión</a>
    </div>

    <script>
        const cuentaBtn = document.querySelector('.register-btn');
        const authPopup = document.getElementById('authPopup');
        const overlay = document.getElementById('overlay');
        const userMenu = document.getElementById('userMenu');
        const toggleLink = document.getElementById('toggleForm');
        const popupTitle = document.getElementById('popupTitle');
        const card = document.querySelector('.card');
        const isLoggedIn = @isLoggedIn.ToString().ToLower() === "true";

        // Abrir popup
        cuentaBtn.addEventListener('click', e => {
            e.preventDefault();
            if (!isLoggedIn) {
                authPopup.classList.add('show');
                overlay.classList.add('show');
            } else {
                userMenu.style.display = userMenu.style.display === 'block' ? 'none' : 'block';
            }
        });

        // Cerrar popup
        function cerrarPopup() {
            authPopup.classList.remove('show');
            overlay.classList.remove('show');
            card.classList.remove('flipped');
            popupTitle.textContent = 'Inicia sesión';
            toggleLink.textContent = '¿No tienes cuenta? Registrate';
        }

        // Alternar login/registro
              const cardContainer = document.querySelector('.card-container'); // definirlo

        toggleLink.addEventListener('click', e => {
            e.preventDefault();
            card.classList.toggle('flipped');

            if (card.classList.contains('flipped')) {
                popupTitle.textContent = 'Registro';
                toggleLink.textContent = '¿Ya tienes cuenta? Inicia sesión';
                // asignar height con !important
                cardContainer.style.setProperty('height', '350px', 'important');
            } else {
                popupTitle.textContent = 'Inicia sesión';
                toggleLink.textContent = '¿No tienes cuenta? Registrate';
                cardContainer.style.setProperty('height', '220px', 'important');
            }
        });


        // Cerrar menú si clic afuera
        document.addEventListener('click', e => {
            if (!userMenu.contains(e.target) && !cuentaBtn.contains(e.target)) {
                userMenu.style.display = 'none';
            }
        });

        // Cerrar popup si clic sobre overlay
        overlay.addEventListener('click', cerrarPopup);
    </script>

</body>
</html>